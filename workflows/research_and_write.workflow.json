{
  "workflow_schema_version": "2.1.0",
  "workflow_id": "1b7a5d54-0c77-4e06-8c01-0b3f1f2e3a11",
  "workflow_name": "research_and_write",
  "description": "Plan, research, and draft a short note using Letta agents referenced from an external .af v2 bundle.",
  "version": "0.1.0",
  "created_at": "2025-09-19T10:00:00Z",
  "updated_at": "2025-09-19T10:00:00Z",

  "imports": [
    {
      "uri": "file://../agents/knowledge-workers.af.json",
      "version": "2"
    }
  ],

  "agents": [
    { "agent_name": "researcher", "agent_ref": { "name": "researcher_v1" } },
    { "agent_name": "writer",     "agent_ref": { "name": "writer_v1" } }
  ],

  "shared_memory_blocks": [],

  "start_step_id": "plan",
  "stop_step_id":  "draft",

  "steps": [
    {
      "step_id": "plan",
      "step_name": "Plan topic and sources",
      "description": "Researcher proposes a brief plan.",
      "invocation_type": "synchronous",
      "agent_name": "researcher",
      "input_source": "workflow_initial",
      "instructions": "Given the user's topic, outline 3 bullet points and 2 candidate sources."
    },
    {
      "step_id": "draft",
      "step_name": "Draft the note",
      "description": "Writer produces a short draft.",
      "invocation_type": "synchronous",
      "agent_name": "writer",
      "input_source": "previous_step",
      "instructions": "Write a 150–200 word draft using the plan and sources from the previous step."
    }
  ],

  "asl": {
    "Comment": "ASL state machine with Letta AgentBinding",
    "StartAt": "Plan",
    "States": {
      "Plan": {
        "Type": "Task",
        "Comment": "Researcher creates a plan",
        "AgentBinding": { "agent_ref": { "name": "researcher_v1" } },
        "Parameters": {
          "prompt": "Outline 3 bullets and 2 sources for the topic: $.topic"
        },
        "ResultPath": "$.plan",
        "Next": "Draft"
      },
      "Draft": {
        "Type": "Task",
        "Comment": "Writer drafts the note",
        "AgentBinding": { "agent_ref": { "name": "writer_v1" } },
        "Parameters": {
          "prompt": "Draft 150–200 words using $.plan"
        },
        "End": true
      }
    }
  }
}
