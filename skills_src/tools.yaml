# MCP Tools Registry
# Defines tool specifications and test cases for simulation
# Version: 1.0.0

apiVersion: tools/v1
kind: ToolsRegistry

servers:
  # ============================================================================
  # SEARCH SERVER - Web and news search capabilities
  # ============================================================================
  search:
    description: Search and discovery tools for web content and news

    tools:
      search_query:
        version: 0.1.0
        description: Mock web search query tool
        params:
          type: object
          properties:
            q:
              type: string
              description: Search query
          required: [q]
        result:
          type: object
          properties:
            hits:
              type: array
              items:
                type: object
                properties:
                  title: { type: string }
                  url: { type: string }
                required: [title, url]
            total: { type: integer }
            generated_at: { type: string }
          required: [hits]
        defaults:
          response: { hits: [] }
          latencyMs: 150
          rateLimit: { rps: 2 }
        cases:
          - id: case_python
            match: { strategy: exact, path: q, value: python }
            response:
              hits:
                - title: Python Software Foundation - Official Site
                  url: https://www.python.org
                - title: PyPI - the Python Package Index
                  url: https://pypi.org
                - title: Real Python Tutorials
                  url: https://realpython.com
              total: 3

          - id: case_market_scan
            match: { strategy: regex, path: q, value: ".*sustainable robotics market.*" }
            response:
              hits:
                - title: "CB Insights: Sustainable Robotics Market Forecast 2025"
                  url: https://cbinsights.example/reports/sustainable-robotics-2025
                - title: "Gartner: Warehouse Automation Leaders"
                  url: https://gartner.example/automation-leaders
                - title: "MIT Tech Review: Green Robotics Innovation"
                  url: https://mittr.example/green-robotics
                - title: "Logistics Today Podcast: Decarbonising Fulfilment"
                  url: https://logistics.example/decarbonising-fulfilment
              total: 4
              generated_at: "{{ now_iso }}"

          - id: case_competitor_signal
            match: { strategy: regex, path: q, value: ".*Acme Robotics competitor.*" }
            response:
              hits:
                - title: "Bloomberg: Rivals Accelerate in Modular Automation"
                  url: https://bloomberg.example/rivals-modular-automation
                - title: "PitchBook: Funding Round - SwiftLift Robotics"
                  url: https://pitchbook.example/swiftlift-series-b
              total: 2
              notes: Sorted by recency

          - id: case_agentic_sales
            match: { strategy: regex, path: q, value: ".*agentic sales enablement.*" }
            response:
              hits:
                - title: "Forrester: Agentic Sales Assistants 2025"
                  url: https://forrester.example/agentic-sales-2025
                - title: "IDC: AI Agents for B2B Pipelines"
                  url: https://idc.example/ai-agents-b2b
                - title: "Case Study: DealVelocity virtual reps"
                  url: https://casehub.example/dealvelocity-virtual-rep
              total: 3
              generated_at: "{{ now_iso }}"

          - id: case_ev_infrastructure
            match: { strategy: regex, path: q, value: ".*EV charging network.*" }
            response:
              hits:
                - title: "IEA: Rapid buildout of urban charging"
                  url: https://iea.example/urban-charging
                - title: "BloombergNEF: Grid impacts of fast charging"
                  url: https://bnef.example/grid-fast-charging
                - title: "UtilityDive: Policy incentives in 2025"
                  url: https://utilitydive.example/ev-policy-2025
              total: 3

          - id: case_data_privacy
            match: { strategy: regex, path: q, value: ".*data privacy compliance.*" }
            response:
              hits:
                - title: "Gartner: Top privacy automation platforms"
                  url: https://gartner.example/privacy-automation
                - title: "IAPP: CPRA enforcement trends"
                  url: https://iapp.example/cpra-trends
              total: 2
              notes: Weighted toward enterprise readiness

      news_headlines:
        version: 0.1.0
        description: Mock top headlines search
        params:
          type: object
          properties:
            topic:
              type: string
              description: Topic to fetch headlines for
          required: [topic]
        result:
          type: object
          properties:
            headlines:
              type: array
              items:
                type: object
                properties:
                  title: { type: string }
                  url: { type: string }
                  source: { type: string }
                  publishedAt: { type: string }
                required: [title, url]
          required: [headlines]
        defaults:
          response: { headlines: [] }
          latencyMs: 200
          rateLimit: { rps: 1 }
        cases:
          - id: case_market_news
            match: { strategy: regex, path: topic, value: ".*market.*" }
            response:
              headlines:
                - title: Market shifts toward sustainable tech
                  url: https://news.example/sustainable-tech
                  source: TechWire
                  publishedAt: "{{ now_iso }}"
                - title: Analysts predict growth in AI tooling
                  url: https://news.example/ai-tools
                  source: MarketBeat
                  publishedAt: "{{ now_iso }}"
                - title: Supply chains prioritise carbon accounting
                  url: https://news.example/carbon-ledgers
                  source: GlobalSupply
                  publishedAt: "{{ now_iso }}"

          - id: case_robotics_news
            match: { strategy: regex, path: topic, value: ".*robotics.*" }
            response:
              headlines:
                - title: Retailers pilot modular warehouse robots
                  url: https://retailnews.example/pilot-modular-robots
                  source: RetailNews
                  publishedAt: "{{ now_iso }}"
                - title: Venture funding accelerates robotics startups
                  url: https://vcwatch.example/robotics-funding
                  source: VCWatch
                  publishedAt: "{{ now_iso }}"
                - title: Analysts flag interoperability as adoption hurdle
                  url: https://industryinsight.example/interoperability
                  source: IndustryInsight
                  publishedAt: "{{ now_iso }}"

          - id: case_ai_agents
            match: { strategy: regex, path: topic, value: ".*agent.*" }
            response:
              headlines:
                - title: Enterprise pilots AI agents for revenue ops
                  url: https://techpulse.example/agent-rev-ops
                  source: TechPulse
                  publishedAt: "{{ now_iso }}"
                - title: Procurement teams test AI co-pilots
                  url: https://procurement.example/ai-copilot
                  source: ProcurementDaily
                  publishedAt: "{{ now_iso }}"
                - title: Analysts flag governance as adoption hurdle
                  url: https://analystdesk.example/agent-governance
                  source: AnalystDesk
                  publishedAt: "{{ now_iso }}"

          - id: case_ev_market
            match: { strategy: regex, path: topic, value: ".*EV charging.*" }
            response:
              headlines:
                - title: Municipalities accelerate fast-charger RFPs
                  url: https://cities.example/fast-charger-rfp
                  source: CityWatch
                  publishedAt: "{{ now_iso }}"
                - title: Utilities test vehicle-to-grid pilots
                  url: https://utilities.example/v2g-pilot
                  source: GridToday
                  publishedAt: "{{ now_iso }}"
                - title: Charging networks consolidate via M&A
                  url: https://finance.example/charging-mna
                  source: FinanceWire
                  publishedAt: "{{ now_iso }}"

  # ============================================================================
  # WEB SERVER - HTTP fetching capabilities
  # ============================================================================
  web:
    description: Web content fetching tools

    tools:
      web_fetch:
        version: 0.1.0
        description: Mock HTTP fetcher
        params:
          type: object
          properties:
            url:
              type: string
              description: URL to fetch
          required: [url]
        result:
          type: object
          properties:
            status: { type: integer }
            body: { type: string }
        defaults:
          response: { status: 200, body: stub }
          latencyMs: 200
          rateLimit: { rps: 0 }  # unlimited

  # ============================================================================
  # DATASETS SERVER - Structured data lookups
  # ============================================================================
  datasets:
    description: Structured dataset access tools

    tools:
      company_profile:
        version: 0.1.0
        description: Mock company intelligence lookup
        params:
          type: object
          properties:
            company:
              type: string
              description: Company name
          required: [company]
        result:
          type: object
          properties:
            profile:
              type: object
              properties:
                overview: { type: string }
                metrics:
                  type: array
                  items:
                    type: object
                    properties:
                      label: { type: string }
                      value: { type: string }
                    required: [label, value]
                customerSegments:
                  type: array
                  items: { type: string }
                productLines:
                  type: array
                  items:
                    type: object
                    properties:
                      name: { type: string }
                      description: { type: string }
                    required: [name]
                recentMilestones:
                  type: array
                  items:
                    type: object
                    properties:
                      date: { type: string }
                      detail: { type: string }
                    required: [date, detail]
              required: [overview]
          required: [profile]
        defaults:
          response:
            profile:
              overview: stub overview
              metrics: []
          latencyMs: 120
          rateLimit: { rps: 1 }
        cases:
          - id: case_acme
            match: { strategy: exact, path: company, value: Acme Robotics }
            response:
              profile:
                overview: Acme Robotics builds modular warehouse automation systems with sustainability telemetry.
                metrics:
                  - { label: Employees, value: "240" }
                  - { label: HQ, value: "Austin, TX" }
                  - { label: Funding, value: "$85M Series C (2024)" }
                  - { label: ARR, value: "$62M" }
                customerSegments: [Mid-market eCommerce, 3PLs]
                productLines:
                  - name: Atlas Grid
                    description: Modular picking and storage robotics
                  - name: Helios Insight
                    description: Energy optimisation and carbon tracking software
                recentMilestones:
                  - { date: "2025-02-18", detail: Signed national rollout with OmniShop }
                  - { date: "2024-12-04", detail: ISO 14001 certification achieved }

          - id: case_swiftlift
            match: { strategy: regex, path: company, value: ".*SwiftLift.*" }
            response:
              profile:
                overview: SwiftLift Robotics provides plug-and-play autonomous lift modules for high-throughput warehouses.
                metrics:
                  - { label: Employees, value: "120" }
                  - { label: HQ, value: "Seattle, WA" }
                  - { label: Funding, value: "$55M Series B (2025)" }
                customerSegments: [Enterprise retailers, Grocery fulfillment]
                productLines:
                  - name: SwiftLift Core
                    description: Autonomous pallet movement system
                recentMilestones:
                  - { date: "2025-01-29", detail: Announced partnership with FreshCart }

          - id: case_ecocharge
            match: { strategy: exact, path: company, value: EcoCharge Networks }
            response:
              profile:
                overview: EcoCharge Networks designs modular EV charging hubs with integrated grid services.
                metrics:
                  - { label: Employees, value: "180" }
                  - { label: HQ, value: "Denver, CO" }
                  - { label: Funding, value: "$95M Series C (2025)" }
                customerSegments: [Municipal fleets, Retail parking operators]
                productLines:
                  - name: PulseHub
                    description: Level 3 fast-charging with battery buffering
                  - name: GridSync
                    description: Demand-response and V2G orchestration
                recentMilestones:
                  - { date: "2025-02-12", detail: Won Austin downtown charging tender }
                  - { date: "2024-11-03", detail: Launched GridSync 2.0 analytics }

          - id: case_northwind
            match: { strategy: regex, path: company, value: ".*Northwind Analytics.*" }
            response:
              profile:
                overview: Northwind Analytics provides privacy-aware customer intelligence for regulated industries.
                metrics:
                  - { label: Employees, value: "320" }
                  - { label: HQ, value: "Toronto, CA" }
                  - { label: ARR, value: "$88M" }
                customerSegments: [Banks, Insurers, Health systems]
                productLines:
                  - name: ComplyIQ
                    description: Privacy automation for data teams
                  - name: SignalRoom
                    description: Consent-aware customer analytics
                recentMilestones:
                  - { date: "2025-01-18", detail: Expanded to EU with Schrems II compliance }

  # ============================================================================
  # ANALYSIS SERVER - Synthesis and comparison tools
  # ============================================================================
  analysis:
    description: Research synthesis and analysis tools

    tools:
      insight_compare:
        version: 0.1.0
        description: Mock synthesis tool combining research insights
        params:
          type: object
          properties:
            insights:
              type: array
              items: { type: object }
          required: [insights]
        result:
          type: object
          properties:
            themes:
              type: array
              items: { type: string }
            risks:
              type: array
              items: { type: string }
            confidence: { type: string }
          required: [themes, risks]
        defaults:
          response: { themes: [], risks: [] }
          latencyMs: 180
          rateLimit: { rps: 1 }
        cases:
          - id: case_themes
            match: { strategy: always }
            response:
              themes:
                - Sustainability positioning
                - AI-enabled optimisation
                - Partnership momentum
              risks:
                - High capital expenditure
                - Crowded vendor landscape
                - Integration complexity
              confidence: medium

          - id: case_supply_chain
            match: { strategy: contains, path: insights, value: supply chain }
            response:
              themes:
                - Supply chain resilience
                - Vendor consolidation
              risks:
                - Regional capacity shortages
                - Integration friction across legacy WMS
              confidence: high

          - id: case_ai_agent
            match: { strategy: contains, path: insights, value: agentic }
            response:
              themes:
                - Operational co-pilots reduce manual load
                - Governance and access control requirements
              risks:
                - Shadow IT deployments
                - Model drift without audit
              confidence: medium

  # ============================================================================
  # LLM SERVER - Language model tools
  # ============================================================================
  llm:
    description: Language model tools for generation and analysis

    tools:
      llm_outline:
        version: 0.1.0
        description: Mock planning LLM for research outlines
        params:
          type: object
          properties:
            topic: { type: string }
            constraints: { type: string }
        result:
          type: object
          properties:
            outline:
              type: array
              items: { type: string }
        defaults:
          response: { outline: [] }
          latencyMs: 80
          rateLimit: { rps: 0 }
        cases:
          - id: case_outline
            match: { strategy: always }
            response:
              outline:
                - Clarify stakeholder questions
                - Prioritise research focus areas
                - Define success metrics
                - List required deliverables
                - Identify data and tooling needs

          - id: case_outline_ev
            match: { strategy: contains, path: topic, value: EV charging }
            response:
              outline:
                - Clarify grid interconnect constraints
                - Map policy incentives by region
                - Benchmark charger utilisation and uptime
                - Identify target partners (utilities, parking operators)
                - Define ROI model for municipalities

      llm_briefing:
        version: 0.1.0
        description: Mock briefing writer
        params:
          type: object
          properties:
            themes:
              type: array
              items: { type: string }
            audience: { type: string }
        result:
          type: object
          properties:
            briefing: { type: string }
        defaults:
          response: { briefing: stub briefing }
          latencyMs: 100
          rateLimit: { rps: 0 }
        cases:
          - id: case_briefing
            match: { strategy: always }
            response:
              briefing: |
                Executive Briefing
                ===================
                Opportunities:
                - Sustainability positioning resonates with enterprise RFP criteria.
                - AI-enabled optimisation reduces fulfilment cost by 18% in pilots.
                Risks:
                - Capital expenditure remains a barrier for mid-market prospects.
                - Integration complexity demands stronger SI partnerships.
                Recommended watch-outs: monitor interoperability roadmap and quantify carbon savings.

          - id: case_briefing_agents
            match: { strategy: contains, path: themes, value: agentic }
            response:
              briefing: |
                Executive Briefing
                ===================
                Opportunities:
                - Agentic co-pilots automate 25-40% of revenue ops tasks.
                - Early movers show pipeline hygiene uplift and faster renewal cycles.
                Risks:
                - Access control and audit trails must satisfy compliance.
                - Change management is needed to avoid user backlash.

      llm_action_plan:
        version: 0.1.0
        description: Mock action plan generator
        params:
          type: object
          properties:
            objectives: { type: string }
            insights:
              type: array
              items: { type: string }
        result:
          type: object
          properties:
            actions:
              type: array
              items: { type: string }
            ownerRecommendations:
              type: object
              additionalProperties: { type: string }
          required: [actions]
        defaults:
          response: { actions: [] }
          latencyMs: 90
          rateLimit: { rps: 0 }
        cases:
          - id: case_actions
            match: { strategy: always }
            response:
              actions:
                - Schedule briefing with product leadership to align on sustainability messaging
                - Commission deeper cost benchmarking study across top 5 target segments
                - Initiate pilot with sustainability-focused client to gather quantified carbon reduction data
                - Engage systems integrator partners to develop integration playbooks
              ownerRecommendations:
                product: Own interoperability roadmap update
                marketing: Publish sustainability proof-points

          - id: case_actions_ev
            match: { strategy: contains, path: objectives, value: charging }
            response:
              actions:
                - Prioritise fast-charger deployments near logistics hubs
                - Co-develop grid services bundle with utility partners
                - Launch pilot measuring dwell-time uplift for retail hosts
                - Publish reliability SLA benchmarks
              ownerRecommendations:
                operations: Own site-readiness checklist
                product: Finalize V2G pricing

      llm_quality_review:
        version: 0.1.0
        description: Mock quality assurance reviewer
        params:
          type: object
          properties:
            draft: { type: string }
            criteria:
              type: array
              items: { type: string }
          required: [draft]
        result:
          type: object
          properties:
            issues:
              type: array
              items: { type: string }
            status: { type: string }
            suggestedFixes:
              type: array
              items: { type: string }
          required: [issues, status]
        defaults:
          response: { issues: [], status: pass }
          latencyMs: 60
          rateLimit: { rps: 0 }
        cases:
          - id: case_review
            match: { strategy: always }
            response:
              issues:
                - Add quantitative metric for market size
                - Clarify responsible team for integration risk mitigation
              status: revise
              suggestedFixes:
                - Reference 2025 market TAM estimate from CB Insights
                - Assign partner management lead to SI playbook development

          - id: case_review_privacy
            match: { strategy: contains, path: draft, value: privacy }
            response:
              issues:
                - Add regulatory citations for CPRA/GDPR
                - Clarify data retention policy and DPIA owner
              status: revise
              suggestedFixes:
                - Reference latest enforcement actions
                - Name responsible data protection officer

      llm_summarize:
        version: 0.1.0
        description: Mock summarisation endpoint
        params:
          type: object
          properties:
            text:
              type: string
              description: Text to summarise
          required: [text]
        result:
          type: object
          properties:
            summary: { type: string }
        defaults:
          response: { summary: stub summary }
          latencyMs: 50
          rateLimit: { rps: 0 }
        cases:
          - id: short_text
            match: { strategy: always }
            response:
              summary: >-
                Executive digest: Market momentum is accelerating for sustainable modular automation;
                top opportunities lie in enterprise retail pilots while capital intensity and
                integration remain key risks. Next steps focus on quantifying ROI and formalising
                partner enablement.

          - id: case_summary_finance
            match: { strategy: contains, path: text, value: finance }
            response:
              summary: >-
                Finance-focused digest: strong capital efficiency but dependence on regulatory
                clarity; continue tracking incentive timelines.

  # ============================================================================
  # ORDERS SERVER - Order validation tools (Phase 1 Testing)
  # ============================================================================
  orders:
    description: Order validation tools for customer, inventory, and address verification

    tools:
      verify_customer:
        version: 0.1.0
        description: Verifies customer exists and is in good standing
        params:
          type: object
          properties:
            customer_id:
              type: string
              description: Customer identifier
          required: [customer_id]
        result:
          type: object
          properties:
            valid: { type: boolean }
            customer_name: { type: string }
            account_status: { type: string }
            credit_limit: { type: number }
            current_balance: { type: number }
        defaults:
          response: { valid: false, error: "Customer not found" }
          latencyMs: 50
          rateLimit: { rps: 5 }
        cases:
          - id: customer_valid
            match: { strategy: exact, path: customer_id, value: "CUST-1234" }
            response:
              valid: true
              customer_name: "Jane Smith"
              account_status: "active"
              credit_limit: 5000.00
              current_balance: 250.00

          - id: customer_inactive
            match: { strategy: exact, path: customer_id, value: "CUST-5678" }
            response:
              valid: false
              customer_name: "Bob Jones"
              account_status: "suspended"
              error: "Account suspended - payment overdue"

      check_inventory:
        version: 0.1.0
        description: Checks inventory availability for order items
        params:
          type: object
          properties:
            items:
              type: array
              description: Array of items with sku and quantity
              items:
                type: object
                properties:
                  sku: { type: string }
                  quantity: { type: integer }
                required: [sku, quantity]
          required: [items]
        result:
          type: object
          properties:
            all_available: { type: boolean }
            items:
              type: array
              items:
                type: object
                properties:
                  sku: { type: string }
                  requested: { type: integer }
                  available: { type: integer }
                  status: { type: string }
        defaults:
          response: { all_available: false, items: [] }
          latencyMs: 75
          rateLimit: { rps: 5 }
        cases:
          - id: items_in_stock
            match: { strategy: regex, path: "items[0].sku", value: "WIDGET.*" }
            response:
              all_available: true
              items:
                - sku: "WIDGET-A"
                  requested: 3
                  available: 150
                  status: "in_stock"
                - sku: "GADGET-B"
                  requested: 1
                  available: 25
                  status: "in_stock"

          - id: items_out_of_stock
            match: { strategy: exact, path: "items[0].sku", value: "RARE-ITEM" }
            response:
              all_available: false
              items:
                - sku: "RARE-ITEM"
                  requested: 1
                  available: 0
                  status: "out_of_stock"

      validate_address:
        version: 0.1.0
        description: Validates shipping address is deliverable
        params:
          type: object
          properties:
            address:
              type: object
              description: Shipping address object
              properties:
                street: { type: string }
                city: { type: string }
                state: { type: string }
                zip: { type: string }
              required: [street, city, state, zip]
          required: [address]
        result:
          type: object
          properties:
            valid: { type: boolean }
            normalized_address:
              type: object
              properties:
                street: { type: string }
                city: { type: string }
                state: { type: string }
                zip: { type: string }
            delivery_zone: { type: string }
            estimated_delivery_days: { type: integer }
        defaults:
          response: { valid: false, error: "Invalid address" }
          latencyMs: 100
          rateLimit: { rps: 5 }
        cases:
          - id: texas_address
            match: { strategy: exact, path: "address.state", value: "TX" }
            response:
              valid: true
              normalized_address:
                street: "123 Main Street"
                city: "Austin"
                state: "TX"
                zip: "78701-1234"
              delivery_zone: "ZONE-A"
              estimated_delivery_days: 3

          - id: california_address
            match: { strategy: exact, path: "address.state", value: "CA" }
            response:
              valid: true
              normalized_address:
                street: "456 Oak Avenue"
                city: "San Francisco"
                state: "CA"
                zip: "94102-5678"
              delivery_zone: "ZONE-B"
              estimated_delivery_days: 5

          - id: invalid_zip
            match: { strategy: exact, path: "address.zip", value: "00000" }
            response:
              valid: false
              error: "Invalid ZIP code"

  # ============================================================================
  # PRICING SERVER - Order pricing tools (Phase 1 Testing)
  # ============================================================================
  pricing:
    description: Pricing calculation tools for subtotals, discounts, taxes, and shipping

    tools:
      calculate_subtotal:
        version: 0.1.0
        description: Calculates subtotal from order items
        params:
          type: object
          properties:
            items:
              type: array
              description: Order items with quantity and unit_price
              items:
                type: object
                properties:
                  sku: { type: string }
                  quantity: { type: integer }
                  unit_price: { type: number }
                required: [sku, quantity, unit_price]
          required: [items]
        result:
          type: object
          properties:
            subtotal: { type: number }
            item_count: { type: integer }
            line_items:
              type: array
              items:
                type: object
                properties:
                  sku: { type: string }
                  quantity: { type: integer }
                  unit_price: { type: number }
                  line_total: { type: number }
        defaults:
          response: { subtotal: 0, item_count: 0, line_items: [] }
          latencyMs: 25
          rateLimit: { rps: 10 }
        cases:
          - id: standard_order
            match: { strategy: regex, path: "items[0].sku", value: ".*" }
            response:
              subtotal: 239.96
              item_count: 4
              line_items:
                - sku: "WIDGET-A"
                  quantity: 3
                  unit_price: 29.99
                  line_total: 89.97
                - sku: "GADGET-B"
                  quantity: 1
                  unit_price: 149.99
                  line_total: 149.99

      apply_discount:
        version: 0.1.0
        description: Applies discount code and returns discount amount
        params:
          type: object
          properties:
            subtotal: { type: number }
            discount_code: { type: string }
          required: [subtotal]
        result:
          type: object
          properties:
            discount_applied: { type: boolean }
            discount_code: { type: string }
            discount_type: { type: string }
            discount_percent: { type: number }
            discount_amount: { type: number }
            subtotal_after_discount: { type: number }
        defaults:
          response: { discount_applied: false, discount_amount: 0 }
          latencyMs: 25
          rateLimit: { rps: 10 }
        cases:
          - id: save10_discount
            match: { strategy: exact, path: discount_code, value: "SAVE10" }
            response:
              discount_applied: true
              discount_code: "SAVE10"
              discount_type: "percentage"
              discount_percent: 10
              discount_amount: 24.00
              subtotal_after_discount: 215.96

          - id: save20_discount
            match: { strategy: exact, path: discount_code, value: "SAVE20" }
            response:
              discount_applied: true
              discount_code: "SAVE20"
              discount_type: "percentage"
              discount_percent: 20
              discount_amount: 48.00
              subtotal_after_discount: 191.96

          - id: no_discount
            match: { strategy: exact, path: discount_code, value: "" }
            response:
              discount_applied: false
              discount_amount: 0
              subtotal_after_discount: 239.96

      calculate_tax:
        version: 0.1.0
        description: Calculates tax based on address and subtotal
        params:
          type: object
          properties:
            subtotal: { type: number }
            state: { type: string }
          required: [subtotal, state]
        result:
          type: object
          properties:
            tax_rate: { type: number }
            tax_amount: { type: number }
            jurisdiction: { type: string }
        defaults:
          response: { tax_rate: 0, tax_amount: 0, jurisdiction: "Unknown" }
          latencyMs: 25
          rateLimit: { rps: 10 }
        cases:
          - id: texas_tax
            match: { strategy: exact, path: state, value: "TX" }
            response:
              tax_rate: 0.0825
              tax_amount: 17.82
              jurisdiction: "Texas State + Austin Local"

          - id: california_tax
            match: { strategy: exact, path: state, value: "CA" }
            response:
              tax_rate: 0.0875
              tax_amount: 18.90
              jurisdiction: "California State + San Francisco Local"

          - id: oregon_no_tax
            match: { strategy: exact, path: state, value: "OR" }
            response:
              tax_rate: 0.0
              tax_amount: 0.0
              jurisdiction: "Oregon (No Sales Tax)"

      calculate_shipping:
        version: 0.1.0
        description: Calculates shipping cost based on items and address
        params:
          type: object
          properties:
            item_count: { type: integer }
            delivery_zone: { type: string }
          required: [item_count, delivery_zone]
        result:
          type: object
          properties:
            shipping_method: { type: string }
            shipping_amount: { type: number }
            estimated_days: { type: integer }
            carrier: { type: string }
        defaults:
          response: { shipping_method: "Standard", shipping_amount: 9.99, estimated_days: 7, carrier: "USPS" }
          latencyMs: 25
          rateLimit: { rps: 10 }
        cases:
          - id: zone_a_shipping
            match: { strategy: exact, path: delivery_zone, value: "ZONE-A" }
            response:
              shipping_method: "Ground"
              shipping_amount: 8.99
              estimated_days: 3
              carrier: "FastShip"

          - id: zone_b_shipping
            match: { strategy: exact, path: delivery_zone, value: "ZONE-B" }
            response:
              shipping_method: "Ground"
              shipping_amount: 12.99
              estimated_days: 5
              carrier: "FastShip"

  # ============================================================================
  # DOCUMENTS SERVER - Document generation tools (Phase 1 Testing)
  # ============================================================================
  documents:
    description: Document generation tools for invoices and business documents

    tools:
      create_invoice:
        version: 0.1.0
        description: Creates formatted invoice document from order data
        params:
          type: object
          properties:
            order_id: { type: string }
            customer_info:
              type: object
              properties:
                customer_id: { type: string }
                name: { type: string }
                email: { type: string }
              required: [customer_id, name]
            line_items:
              type: array
              items:
                type: object
                properties:
                  sku: { type: string }
                  item_description: { type: string }
                  quantity: { type: integer }
                  unit_price: { type: number }
                  amount: { type: number }
                required: [sku, quantity, unit_price]
            totals:
              type: object
              properties:
                subtotal: { type: number }
                discount: { type: number }
                tax: { type: number }
                shipping: { type: number }
                total: { type: number }
              required: [total]
          required: [order_id, totals]
        result:
          type: object
          properties:
            invoice_id: { type: string }
            invoice_date: { type: string }
            order_id: { type: string }
            status: { type: string }
            customer_info:
              type: object
              properties:
                customer_id: { type: string }
                name: { type: string }
                billing_address: { type: string }
              required: [customer_id, name]
            line_items:
              type: array
              items:
                type: object
                properties:
                  item_description: { type: string }
                  quantity: { type: integer }
                  unit_price: { type: number }
                  amount: { type: number }
                required: [quantity, amount]
            totals:
              type: object
              properties:
                subtotal: { type: number }
                discount: { type: number }
                tax: { type: number }
                shipping: { type: number }
                total: { type: number }
              required: [total]
            payment_terms: { type: string }
            due_date: { type: string }
            document_url: { type: string }
        defaults:
          response:
            invoice_id: "INV-DEFAULT"
            status: "generated"
            payment_terms: "NET-30"
          latencyMs: 150
          rateLimit: { rps: 3 }
        cases:
          - id: standard_invoice
            match: { strategy: regex, path: order_id, value: "ORD-.*" }
            response:
              invoice_id: "INV-2025-0042"
              invoice_date: "2025-01-30T10:30:00Z"
              order_id: "ORD-2025-0042"
              status: "generated"
              customer_info:
                customer_id: "CUST-1234"
                name: "Jane Smith"
                billing_address: "123 Main Street, Austin, TX 78701"
              line_items:
                - item_description: "WIDGET-A"
                  quantity: 3
                  unit_price: 29.99
                  amount: 89.97
                - item_description: "GADGET-B"
                  quantity: 1
                  unit_price: 149.99
                  amount: 149.99
              totals:
                subtotal: 239.96
                discount: -24.00
                tax: 17.82
                shipping: 8.99
                total: 242.77
              payment_terms: "NET-30"
              due_date: "2025-03-01"
              document_url: "https://docs.example.com/invoices/INV-2025-0042.pdf"

  # ============================================================================
  # SUPPORT SERVER - Customer support tools (Phase 2 Testing)
  # ============================================================================
  support:
    description: Customer support tools for profile lookup, issue diagnosis, and response composition

    tools:
      get_customer_profile:
        version: 0.1.0
        description: Retrieves customer profile and account details
        params:
          type: object
          properties:
            customer_id:
              type: string
              description: Customer account identifier
          required: [customer_id]
        result:
          type: object
          properties:
            customer_id: { type: string }
            name: { type: string }
            email: { type: string }
            phone: { type: string }
            account_type: { type: string }
            account_status: { type: string }
            created_date: { type: string }
            subscription_tier: { type: string }
            payment_status: { type: string }
            flags: { type: array, items: { type: string } }
        defaults:
          response: { error: "Customer not found", customer_id: null }
          latencyMs: 75
          rateLimit: { rps: 5 }
        cases:
          - id: premium_customer
            match: { strategy: exact, path: customer_id, value: "ACCT-7890" }
            response:
              customer_id: "ACCT-7890"
              name: "Michael Chen"
              email: "m.chen@example.com"
              phone: "+1-555-0142"
              account_type: "Premium"
              account_status: "active"
              created_date: "2023-06-15"
              subscription_tier: "Business Plus"
              payment_status: "current"
              flags:
                - "VIP_CUSTOMER"
                - "BETA_FEATURES_ENABLED"

          - id: standard_customer
            match: { strategy: exact, path: customer_id, value: "ACCT-1234" }
            response:
              customer_id: "ACCT-1234"
              name: "Sarah Johnson"
              email: "s.johnson@example.com"
              phone: "+1-555-0198"
              account_type: "Standard"
              account_status: "active"
              created_date: "2024-01-10"
              subscription_tier: "Starter"
              payment_status: "current"
              flags: []

      get_interaction_history:
        version: 0.1.0
        description: Retrieves recent customer interactions
        params:
          type: object
          properties:
            customer_id: { type: string }
            limit: { type: integer, default: 5 }
          required: [customer_id]
        result:
          type: object
          properties:
            customer_id: { type: string }
            interactions:
              type: array
              items:
                type: object
                properties:
                  id: { type: string }
                  date: { type: string }
                  channel: { type: string }
                  type: { type: string }
                  status: { type: string }
                  agent: { type: string }
                  summary: { type: string }
            total_interactions: { type: integer }
            avg_resolution_time_hours: { type: number }
        defaults:
          response: { customer_id: null, interactions: [], total_interactions: 0 }
          latencyMs: 100
          rateLimit: { rps: 5 }
        cases:
          - id: recent_interactions
            match: { strategy: exact, path: customer_id, value: "ACCT-7890" }
            response:
              customer_id: "ACCT-7890"
              interactions:
                - id: "INT-4521"
                  date: "2025-01-28"
                  channel: "email"
                  type: "password_reset_request"
                  status: "completed"
                  agent: "auto"
                  summary: "Customer requested password reset"
                - id: "INT-4498"
                  date: "2025-01-15"
                  channel: "chat"
                  type: "billing_inquiry"
                  status: "resolved"
                  agent: "Sarah K."
                  summary: "Question about invoice charges"
                - id: "INT-4312"
                  date: "2024-12-20"
                  channel: "phone"
                  type: "feature_request"
                  status: "logged"
                  agent: "David M."
                  summary: "Request for API access"
              total_interactions: 12
              avg_resolution_time_hours: 4.2

      search_known_issues:
        version: 0.1.0
        description: Searches knowledge base for known issues
        params:
          type: object
          properties:
            symptoms:
              type: string
              description: Issue symptoms to search for
            category: { type: string }
          required: [symptoms]
        result:
          type: object
          properties:
            matches_found: { type: integer }
            known_issues:
              type: array
              items:
                type: object
                properties:
                  id: { type: string }
                  title: { type: string }
                  category: { type: string }
                  severity: { type: string }
                  root_cause: { type: string }
                  resolution: { type: string }
                  workaround: { type: string }
                  status: { type: string }
                  fix_version: { type: string }
        defaults:
          response: { matches_found: 0, known_issues: [] }
          latencyMs: 150
          rateLimit: { rps: 3 }
        cases:
          - id: password_reset_issue
            match: { strategy: regex, path: symptoms, value: ".*password.*reset.*" }
            response:
              matches_found: 2
              known_issues:
                - id: "KB-2024-1847"
                  title: "Dashboard access blocked after password reset"
                  category: "authentication"
                  severity: "medium"
                  root_cause: "Session cache not cleared after password change"
                  resolution: "Clear browser cache and cookies, then log in again"
                  workaround: "Use incognito/private browsing window"
                  status: "fix_deployed"
                  fix_version: "2.5.1"
                - id: "KB-2024-1652"
                  title: "MFA token sync delay after credential change"
                  category: "authentication"
                  severity: "low"
                  root_cause: "MFA token propagation delay (up to 5 minutes)"
                  resolution: "Wait 5 minutes after password reset before logging in"
                  status: "known_limitation"

          - id: login_issue
            match: { strategy: regex, path: symptoms, value: ".*login.*fail.*" }
            response:
              matches_found: 1
              known_issues:
                - id: "KB-2024-1901"
                  title: "Login failures during peak hours"
                  category: "authentication"
                  severity: "high"
                  root_cause: "Rate limiting triggers during high traffic"
                  resolution: "Wait 15 minutes and retry"
                  status: "monitoring"

      check_system_status:
        version: 0.1.0
        description: Checks current system status and outages
        params:
          type: object
          properties:
            service: { type: string, default: "all" }
        result:
          type: object
          properties:
            overall_status: { type: string }
            last_updated: { type: string }
            services:
              type: array
              items:
                type: object
                properties:
                  name: { type: string }
                  status: { type: string }
                  uptime_30d: { type: string }
            recent_incidents: { type: array }
            scheduled_maintenance: { type: object }
        defaults:
          response:
            overall_status: "operational"
            services: []
          latencyMs: 50
          rateLimit: { rps: 10 }
        cases:
          - id: all_systems_normal
            match: { strategy: exact, path: service, value: "all" }
            response:
              overall_status: "operational"
              last_updated: "2025-01-30T10:00:00Z"
              services:
                - name: "Authentication Service"
                  status: "operational"
                  uptime_30d: "99.98%"
                - name: "Dashboard"
                  status: "operational"
                  uptime_30d: "99.95%"
                - name: "API Gateway"
                  status: "operational"
                  uptime_30d: "99.99%"
                - name: "Database Cluster"
                  status: "operational"
                  uptime_30d: "99.99%"
              recent_incidents: []
              scheduled_maintenance: null

          - id: auth_degraded
            match: { strategy: exact, path: service, value: "auth" }
            response:
              overall_status: "degraded"
              last_updated: "2025-01-30T10:00:00Z"
              services:
                - name: "Authentication Service"
                  status: "degraded"
                  uptime_30d: "99.85%"
              recent_incidents:
                - id: "INC-2025-0142"
                  start: "2025-01-30T09:45:00Z"
                  summary: "Elevated login latency"
                  status: "investigating"

      analyze_account_logs:
        version: 0.1.0
        description: Analyzes account activity logs for anomalies
        params:
          type: object
          properties:
            customer_id: { type: string }
            hours_back: { type: integer, default: 24 }
          required: [customer_id]
        result:
          type: object
          properties:
            customer_id: { type: string }
            analysis_period: { type: string }
            events:
              type: array
              items:
                type: object
                properties:
                  timestamp: { type: string }
                  event: { type: string }
                  source: { type: string }
                  ip: { type: string }
                  status: { type: string }
                  error_code: { type: string }
            anomalies:
              type: array
              items:
                type: object
                properties:
                  type: { type: string }
                  description: { type: string }
                  error_code: { type: string }
                  recommendation: { type: string }
        defaults:
          response: { customer_id: null, events: [], anomalies: [] }
          latencyMs: 200
          rateLimit: { rps: 3 }
        cases:
          - id: password_reset_logs
            match: { strategy: exact, path: customer_id, value: "ACCT-7890" }
            response:
              customer_id: "ACCT-7890"
              analysis_period: "24 hours"
              events:
                - timestamp: "2025-01-30T08:15:22Z"
                  event: "PASSWORD_RESET_INITIATED"
                  source: "web_portal"
                  ip: "192.168.1.105"
                  status: "success"
                - timestamp: "2025-01-30T08:16:45Z"
                  event: "PASSWORD_RESET_COMPLETED"
                  source: "email_link"
                  ip: "192.168.1.105"
                  status: "success"
                - timestamp: "2025-01-30T08:17:30Z"
                  event: "LOGIN_ATTEMPT"
                  source: "web_portal"
                  ip: "192.168.1.105"
                  status: "success"
                - timestamp: "2025-01-30T08:17:35Z"
                  event: "DASHBOARD_ACCESS"
                  source: "web_portal"
                  ip: "192.168.1.105"
                  status: "failed"
                  error_code: "SESSION_CACHE_STALE"
                - timestamp: "2025-01-30T08:18:00Z"
                  event: "DASHBOARD_ACCESS"
                  source: "web_portal"
                  ip: "192.168.1.105"
                  status: "failed"
                  error_code: "SESSION_CACHE_STALE"
              anomalies:
                - type: "repeated_failure"
                  description: "Multiple dashboard access failures after successful login"
                  error_code: "SESSION_CACHE_STALE"
                  recommendation: "Clear session cache or use private browsing"

      get_response_templates:
        version: 0.1.0
        description: Retrieves response templates for issue category
        params:
          type: object
          properties:
            category: { type: string }
            tone: { type: string, default: "professional" }
          required: [category]
        result:
          type: object
          properties:
            templates:
              type: array
              items:
                type: object
                properties:
                  id: { type: string }
                  name: { type: string }
                  subject_template: { type: string }
                  body_template: { type: string }
                  tone: { type: string }
                  tags: { type: array, items: { type: string } }
        defaults:
          response: { templates: [] }
          latencyMs: 75
          rateLimit: { rps: 5 }
        cases:
          - id: auth_templates
            match: { strategy: exact, path: category, value: "authentication" }
            response:
              templates:
                - id: "TPL-AUTH-001"
                  name: "Password Reset Follow-up"
                  subject_template: "Re: Access Issue After Password Reset - [TICKET_ID]"
                  body_template: |
                    Hi [CUSTOMER_NAME],

                    Thank you for reaching out about the dashboard access issue you're experiencing after your recent password reset.

                    We've identified this as a known issue (KB-2024-1847) related to session caching. Here's how to resolve it:

                    **Quick Fix:**
                    1. Clear your browser cache and cookies
                    2. Close all browser windows
                    3. Open a new browser window and log in again

                    **Alternative:**
                    - Try accessing the dashboard in an incognito/private browsing window

                    This issue has been fixed in our latest release (v2.5.1), which will be automatically applied to your account within the next 24 hours.

                    If you continue experiencing issues after trying these steps, please reply to this email and we'll investigate further.

                    Best regards,
                    [AGENT_NAME]
                    Customer Support Team
                  tone: "professional"
                  tags: ["password", "access", "cache"]

          - id: billing_templates
            match: { strategy: exact, path: category, value: "billing" }
            response:
              templates:
                - id: "TPL-BILL-001"
                  name: "Billing Inquiry Response"
                  subject_template: "Re: Billing Question - [TICKET_ID]"
                  body_template: |
                    Hi [CUSTOMER_NAME],

                    Thank you for contacting us about your billing question.

                    [BILLING_DETAILS]

                    If you have any additional questions, please don't hesitate to reach out.

                    Best regards,
                    [AGENT_NAME]
                    Customer Support Team
                  tone: "professional"
                  tags: ["billing", "invoice", "payment"]
